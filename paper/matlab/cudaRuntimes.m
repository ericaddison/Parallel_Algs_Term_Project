clear all
close all
clc

data = [2, 28.133392334, 27, 24, 21, 631, 128.064, 171859, 68.768, 1348, 1436
3, 30.9944152832, 44, 27, 27, 586, 128.736, 175593, 82.112, 1346, 1342
4, 30.9944152832, 94, 34, 26, 617, 132.032, 172150, 81.44, 1561, 1250
5, 41.0079956055, 251, 50, 31, 608, 131.872, 177139, 70.848, 1539, 1349
6, 35.0475311279, 808, 67, 36, 598, 135.84, 177152, 129.28, 1486, 1360
7, 39.1006469727, 2725, 139, 63, 628, 138.432, 172107, 114.24, 1736, 1153
8, 49.1142272949, 9843, 268, 111, 601, 141.12, 176997, 130.848, 7162, 1488
9, 78.9165496826, 36769, 539, 224, 615, 148.992, 172973, 132.256, 8027, 1624
10, 110.864639282, 140960, 1121, 463, 635, 154.912, 178235, 140.48, 2418, 9834
11, 198.841094971, 552532, 2342, 976, 702, 182.016, 171112, 126.016, 24181, 2052
12, 380.992889404, 2181300, 4923, 2083, 748, 202.368, 204766, 14413.6, 12344, 16558
13, 767.946243286, 8687809, 10490, 4514, 807, 225.088, 171736, 78.816, 15011, 22043
14, 1503.94439697, 34827031, 21986, 9637, 1048, 306.272, 177368, 82.496, 23946, 22293
15, 2878.90434265, 138472516, 46465, 20507, 1391, 407.456, 174569, 90.688, 12612, 8845
16, 6315.94657898, 0, 97113, 43478, 2239, 554.4, 179931, 110.08, 17760, 10053
17, 14116.0488129, 0, 203953, 92032, 3114, 1090.53, 178805, 163.232, 13259, 16822
18, 31052.1125793, 0, 425882, 194453, 5246, 2222.88, 206014, 250.496, 39362, 35416
19, 61925.1728058, 0, 894230, 413050, 11245, 4610.21, 180290, 450.24, 72812, 25972
20, 137110.948563, 0, 1862299, 901021, 22191, 9673.47, 188666, 832.768, 132261, 69145
21, 282196.044922, 0, 3885650, 1945181, 45638, 20279, 193726, 1562.21, 213522, 112775
22, 605030.059814, 0, 8095647, 4096114, 93820, 42444.7, 212513, 3305.28, 481448, 242619
23, 1241040.94505, 0, 16788493, 8499640, 163055, 88816.4, 255913, 7863.26, 954211, 561711
24, 2767575.97923, 0, 34592042, 17686005, 399083, 191183, 337611, 15923.9, 1770091, 1155788
25, 5827072.85881, 0, 72466620, 36976194, 838862, 422557, 530758, 31706.6, 3910600, 2298287
26, 12697794.199, 0, 149454051, 76174312, 1499365, 903130, 830786, 64299, 7269575, 4634823
27, 0, 0, 0, 0, 3099790, 1.91439e+06, 1483666, 127936, 15252609, 9717194];

n = data(:,1);
numpy = data(:,2);
dft = data(1:14,3);
fft_rec = data(:,4);
fft_iter = data(:,5);
fft_cuda = data(:,6);
fft_cuda_inner = data(:,7);
fft_cufft = data(:,8);
fft_cufft_inner = data(:,9);

close all
plot(n,log10(numpy),'-s','MarkerSize',2,'LineWidth',2)
hold on
plot(n(1:14),log10(dft),'-sr','MarkerSize',2,'LineWidth',2)
plot(n,log10(fft_rec),'-sg','MarkerSize',2,'LineWidth',2)
plot(n,log10(fft_iter),'-sk','MarkerSize',2,'LineWidth',2)
l = legend('numpy','dft', 'recursive','iterative')
set(l,...
    'Position',[0.158691406250001 0.717122395833334 0.2119140625 0.174153645833333]);

title('Runtimes for sequential FFT implementations')
ylabel('Time (log_{10}(us))')
xlabel('Array Size (log_2(n))')
set(gca,'ygrid','on','GridLineStyle','-')
set(gcf, 'PaperUnits', 'points');
set(gcf, 'PaperPosition', [100, 100, 500, 250]);
saveas(gcf,['./seqRuntimes'],'epsc');


figure
plot(n,log10(numpy),'-s','MarkerSize',2,'LineWidth',2)
hold on
plot(n,log10(fft_cuda),'-sr','MarkerSize',2,'LineWidth',2)
plot(n,log10(fft_cuda_inner),'-sg','MarkerSize',2,'LineWidth',2)
plot(n,log10(fft_cufft),'-sk','MarkerSize',2,'LineWidth',2)
plot(n,log10(fft_cufft_inner),'-sm','MarkerSize',2,'LineWidth',2)
l = legend('numpy','Cuda', 'Cuda-inner','CUFFT', 'CUFFT-inner')
set(l,...
    'Position',[0.160400390625001 0.668619791666667 0.25146484375 0.21484375]);


title('Runtimes for cuda FFT implementations')
ylabel('Time (log_{10}(us))')
xlabel('Array Size (log_2(n))')
set(gca,'ygrid','on','GridLineStyle','-')
set(gcf, 'PaperUnits', 'points');
set(gcf, 'PaperPosition', [100, 100, 500, 250]);
saveas(gcf,['./cudaRuntimes'],'epsc');
